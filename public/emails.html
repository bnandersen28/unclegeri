<!DOCTYPE html>
<html lang="en">
<script>
    if (localStorage.getItem('authenticated') !== 'true') {
        alert('You must be logged in to access this page.');
        window.location.href = 'login.html';
    }
</script>

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="style.css">
    <title>Edit emails</title>
    <!-- Quill -->
    <link href="https://cdn.quilljs.com/1.3.6/quill.snow.css" rel="stylesheet">
    <script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
</head>

<body>
    <div class="header">
        <div class="header-top"></div>
        <div class="header-content">

            <div class="nav-left">
                <a href="courses.html"><button>Courses</button></a>
                <a href="register.html"><button>Register</button></a>
            </div>


            <a href="index.html" class="header-logo">
                <img src="imgs/logo.png" alt="Logo">
            </a>

            <div class="nav-right">
                <a href="faq.html"><button>FAQs</button></a>
                <a href="connect.html"><button>Connect</button></a>
            </div>


        </div>

    </div>

    <div class="container">
        <h1>Edit Course Emails</h1>

        <!-- Course block -->
        <div class="course-item">
            <div class="course-header" onclick="toggleForm('form1')">Behind the Wheel</div>
            <div class="course-form" id="form1">
                <label>Subject:</label><br>
                <input type="text" id="subject1" name="subject" placeholder="Email subject"><br><br>
                <label>Body:</label>
                <div id="editor1" style="height:150px; background:white;"></div>
                <button type="button" onclick="saveEmail('subject1','quill1')">Save</button>
            </div>
        </div>

        <div class="course-item">
            <div class="course-header" onclick="toggleForm('form2')">1-1 Driving Lessons</div>
            <div class="course-form" id="form2">
                <label>Subject:</label><br>
                <input type="text" id="subject2" name="subject" placeholder="Email subject"><br><br>
                <label>Body:</label>
                <div id="editor2" style="height:150px; background:white;"></div>
                <button type="button" onclick="saveEmail('subject2','quill2')">Save</button>
            </div>
        </div>
        <div class="course-item">
            <div class="course-header" onclick="toggleForm('form3')">Adult Road Test</div>
            <div class="course-form" id="form3">
                <label>Subject:</label><br>
                <input type="text" id="subject3" name="subject" placeholder="Email subject"><br><br>
                <label>Body:</label>
                <div id="editor3" style="height:150px; background:white;"></div>
                <button type="button" onclick="saveEmail('subject3','quill3')">Save</button>
            </div>
        </div>

        <div class="course-item">
            <div class="course-header" onclick="toggleForm('form4')">Online Driver's Education</div>
            <div class="course-form" id="form4">
                <label>Subject:</label><br>
                <input type="text" id="subject4" name="subject" placeholder="Email subject"><br><br>
                <label>Body:</label>
                <div id="editor4" style="height:150px; background:white;"></div>
                <button type="button" onclick="saveEmail('subject4','quill4')">Save</button>
            </div>
        </div>
        <div class="course-item">
            <div class="course-header" onclick="toggleForm('form5')">Driver Manual 3XF</div>
            <div class="course-form" id="form5">
                <label>Subject:</label><br>
                <input type="text" id="subject5" name="subject" placeholder="Email subject"><br><br>
                <label>Body:</label>
                <div id="editor5" style="height:150px; background:white;"></div>
                <button type="button" onclick="saveEmail('subject5','quill5')">Save</button>
            </div>
        </div>
        <div class="course-item">
            <div class="course-header" onclick="toggleForm('form6')">Driver Improvement Clinic</div>
            <div class="course-form" id="form6">
                <label>Subject:</label><br>
                <input type="text" id="subject6" name="subject" placeholder="Email subject"><br><br>
                <label>Body:</label>
                <div id="editor6" style="height:150px; background:white;"></div>
                <button type="button" onclick="saveEmail('subject6','quill6')">Save</button>
            </div>
        </div>

    </div>

    <script>
        // Initialize Quill editors
        const quill1 = new Quill('#editor1', { theme: 'snow' });
        const quill2 = new Quill('#editor2', { theme: 'snow' });
        const quill3 = new Quill('#editor3', { theme: 'snow' });
        const quill4 = new Quill('#editor4', { theme: 'snow' });
        const quill5 = new Quill('#editor5', { theme: 'snow' });
        const quill6 = new Quill('#editor6', { theme: 'snow' });
        // add more as needed

        // Toggle visibility of forms
        function toggleForm(id) {
            const form = document.getElementById(id);
            form.style.display = form.style.display === "block" ? "none" : "block";
        }

        // Save email (send to backend)
        function saveEmail(subjectId, editorVar) {
            const subject = document.getElementById(subjectId).value;
            const body = window[editorVar].root.innerHTML;

            const data = { subject, body };
            fetch('/api/saveEmailTemplate', {
                method: 'POST',
                headers: { 'Content-Type': 'application/json' },
                body: JSON.stringify(data)
            }).then(res => {
                if (res.ok) alert("Saved successfully!");
                else alert("Error saving email");
            });
        }
    </script>
</body>

</html>